//////////////////////////////////////////////////////////////////////////////
var inNode=(typeof window == 'undefined' );
if(typeof module == 'undefined'){
  module={};
} else { 
}
//////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////

function query4a_mav(){
  var subq=select()
             .from("@lineitem")
             .field("@*")
             .where(eq("@l_orderkey","@o_orderkey"),
                    lt("@l_commitdate","@l_receiptdate"));
  return select()
    .open("@o_orderdate")
    .from("@orders")
    .field("@o_orderpriority", as(count("@o_orderpriority"),"order_count"))
    .where(exists(subq))
    .group("@o_orderpriority")
    .order("@o_orderpriority");
}
//////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////
if(inNode){
  global.query4a_mav=query4a_mav;
  module.exports=query4a_mav;
} else delete module;
//////////////////////////////////////////////////////////////////////////////
