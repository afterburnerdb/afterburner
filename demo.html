<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Afterburner Demo</title>
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css"> 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/1.0.4/pako.min.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

  <style type="text/css">
    body {
      padding-top: 50px;
    }
    pre.prettyprint {
      border: 1px solid #ccc;
      margin-bottom: 0;
      padding: 9.5px;
    }
    .table-nonfluid {
      width: auto !important;
    }
    .table-responsive {
      overflow: auto;
    }

  </style>
       <!-- width: 80%; -->
<!--      .table-responsive {
        max-height: 150px;
        overflow: auto;
      }-->

  </head>
  <body>

    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Afterburner</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="./index.html">Home</a></li>
            <li class="active"><a href="./demo.html?hip">Demo</a></li>
            <li class="active"><a href="./demo.html?hip&med">Demo (medium)</a></li>
            <li class="active"><a href="./demo.html?hip&sml">Demo (small)</a></li>

            <li><a href="https://github.com/lintool/afterburner/">Code (GitHub)</a></li>
          </ul>

        </div><!--/.navbar-collapse -->
      </div>
    </nav>

    <!-- Main jumbotron for a primary marketing message or call to action -->

<!--<div>
      <a>Load a table from a file server.</a><br>
     Server: <input type="text" name="fserverIP" value="127.0.0.1"><br>
     Port: <input type="text" name="fserverPort" value="55443"><br>
     <button submit="submit" id="loadserver">get table from server</button><hr>
</div>-->

<!-- <div class="jumbotron"> -->
  <div class="container">
    <div class="row">
      <div class="col-md-3">
        <label class="btn btn-default btn-file" href="#" data-placement="bot">
          Load a table from local disk
          <input type="file" id="fileInput" style="display: none;" multiple> 
        </label>
      </div>
      <div class="col-md-3">
        <label class="btn btn-default btn-file" href="#" data-placement="bot" onclick="loadWeb()" >
          Load demo tables from web
          <!--<button tyle="display: none;" onclick="loadWeb()">Load demo tables from web</button>-->
        </label>
      </div>
      <div class="col-md-3">
        <label class="btn btn-default btn-file" id="schmbtn" href="#" data-toggle="tooltip" data-placement="bot" onclick="togSchema(this)" >
          Show tables
        </label>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <div id="sconsole" class="table-responsive">
        </div>
      <div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <h2>Fluent SQL</h2>
      	<textarea rows="11" id="TAFluent" name="TAFluent" class="prettyprint form-control animated linenums language-css" placeholder="Type Fluent SQL or use example buttons.."></textarea>
              <div class="dropdown">
                <button class="btn btn-default dropdown-toggle" onchange="alert('boom')" type="button" id="menu1" data-toggle="dropdown">Insert TPC-H Query<span class="caret"></span></button>
                <ul class="dropdown-menu" role="menu" aria-labelledby="menu1">
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query1">Q1</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query2">Q2</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query3">Q3</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query4">Q4</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query5">Q5</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query6">Q6</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query7">Q7</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query8">Q8</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query9">Q9</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query10">Q10</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query11">Q11</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query12">Q12</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query13">Q13</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query14">Q14</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query15">Q15</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query16">Q16</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query17">Q17</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query18">Q18</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query19">Q19</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query20">Q20</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query21">Q21</a></li>
                  <li role="presentation"><a role="menuitem" tabindex="-1" href="#" id="query22">Q22</a></li>
                </ul>
              </div>
              <button type="button" onclick="runcode()" class="btn btn-default" href="#" data-placement="bot"> Run code</button>
      </div>
    </div>
    <br>
    <div class="row" id="divconsole">
      <div class="col-md-12">
        <p id="console"></p>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <div id="divcons" class="table-responsive">
        </div>
      </div>
    </div>
  </div> <!-- /container -->

<div id="waitForPT" class="modal fade" style="left" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
      </div>
      <div class="modal-body">
      </div>
      <div class="modal-footer">
          <div class='col-md-1'>
            <button id="modalgate" type="button" onclick="$('#waitForPT').modal('hide');$('#schmbtn').click();" class="btn btn-default" disabled>Got it..</button>
          </div>
      </div>
    </div>
  </div>
</div>

<!-- Afterburner -->

<script src="./src/core/afterburner.js"></script>
<script src="./src/core/store.js"></script>
<script src="./src/core/aSchema.js"></script>
<script src="./src/core/aTable.js"></script>
<script src="./src/core/queryResult.js"></script>
<script src="./src/core/hashIndex.js"></script>
<script src="./src/core/dataSource.js"></script>
<script src="./src/core/common.js"></script>
<script src="./src/core/html5FileParser.js"></script>
<script src="./src/core/urlParser.js"></script>
<script src="./src/frontend/myJS.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
<script src="./src/frontend/web.js"></script>
<script src="./src/frontend/progressTracker.js"></script>

<!-- TPC-H -->

<script src="./src/tpch/q01.js"></script>
<script src="./src/tpch/q02.js"></script>
<script src="./src/tpch/q03.js"></script>
<script src="./src/tpch/q04.js"></script>
<script src="./src/tpch/q05.js"></script>
<script src="./src/tpch/q06.js"></script>
<script src="./src/tpch/q07.js"></script>
<script src="./src/tpch/q08.js"></script>
<script src="./src/tpch/q09.js"></script>
<script src="./src/tpch/q10.js"></script>
<script src="./src/tpch/q11.js"></script>
<script src="./src/tpch/q12.js"></script>
<script src="./src/tpch/q13.js"></script>
<script src="./src/tpch/q14.js"></script>
<script src="./src/tpch/q15.js"></script>
<script src="./src/tpch/q16.js"></script>
<script src="./src/tpch/q17.js"></script>
<script src="./src/tpch/q18.js"></script>
<script src="./src/tpch/q19.js"></script>
<script src="./src/tpch/q20.js"></script>
<script src="./src/tpch/q21.js"></script>
<script src="./src/tpch/q22.js"></script>

<script src="./src/tpch/answers/ans1.js"></script>
<script src="./src/tpch/answers/ans2.js"></script>
<script src="./src/tpch/answers/ans3.js"></script>
<script src="./src/tpch/answers/ans4.js"></script>
<script src="./src/tpch/answers/ans5.js"></script>
<script src="./src/tpch/answers/ans6.js"></script>
<script src="./src/tpch/answers/ans7.js"></script>
<script src="./src/tpch/answers/ans8.js"></script>
<script src="./src/tpch/answers/ans9.js"></script>
<script src="./src/tpch/answers/ans10.js"></script>
<script src="./src/tpch/answers/ans11.js"></script>
<script src="./src/tpch/answers/ans12.js"></script>
<script src="./src/tpch/answers/ans13.js"></script>
<script src="./src/tpch/answers/ans14.js"></script>
<script src="./src/tpch/answers/ans15.js"></script>
<script src="./src/tpch/answers/ans16.js"></script>
<script src="./src/tpch/answers/ans17.js"></script>
<script src="./src/tpch/answers/ans18.js"></script>
<script src="./src/tpch/answers/ans19.js"></script>
<script src="./src/tpch/answers/ans20.js"></script>
<script src="./src/tpch/answers/ans21.js"></script>
<script src="./src/tpch/answers/ans22.js"></script>

<script src="./src/tpch/benchmark_tpch.js"></script>
<script src="./src/micro/benchmark_micro.js"></script>


  
<script>
function myOnLoad(){
  abdb = new Afterburner();
}
window.onload = function() {
  inNode=false;
  var fileInput = document.getElementById('fileInput');
  fileInput.addEventListener('change', function(e) {
    PTi.trackFiles(fileInput.files);
    var files = fileInput.files;
    var ds= new dataSource(files, function(){newTable= new aTable(ds);},0);
  });
  myOnLoad();
}
function URLList(){
  this.list=[];
}
function loadWeb(){
  var urls= new URLList();
  urls.list=[
    "https://lintool.github.io/afterburner-data/lineitem.1319015.tbl.gz",
    "https://lintool.github.io/afterburner-data/nation.25.tbl.gz",
    "https://lintool.github.io/afterburner-data/orders.1500000.tbl.gz",
    "https://lintool.github.io/afterburner-data/part.200000.tbl.gz",
    "https://lintool.github.io/afterburner-data/partsupp.800000.tbl.gz",
    "https://lintool.github.io/afterburner-data/region.5.tbl.gz",
    "https://lintool.github.io/afterburner-data/supplier.10000.tbl.gz",
    "https://lintool.github.io/afterburner-data/customer.150000.tbl.gz"];
  PTi.trackURLs(urls.list);
  var ds= new dataSource(urls, function(){newTable= new aTable(ds);});
}
function runcode(){
  var codecode=document.getElementById("TAFluent").value;
//  document.getElementById("console").innerHTML = "code=" + codecode;
  var tt0=window.performance.now();
  runMyAdhocCode(codecode);
  var tt1=window.performance.now();
  var ttot=tt1-tt0;
  document.getElementById("console").innerHTML = "Total time to run (ms)=" + (ttot.toFixed(2));
  console.log('time to run code:'+ (ttot));
}
function printtable(htmltable){
  divcons=document.getElementById("divcons");
  clearElement(divcons);
  divcons.appendChild(htmltable);
}
</script>


<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<!-- <script src="bootstrap/jquery.min.js"></script>-->
  <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script> -->

<!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script> -->
<script src="bootstrap/js/bootstrap.min.js"></script>

<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="https://maxcdn.bootstrapcdn.com/js/ie10-viewport-bug-workaround.js"></script>

<script type="text/javascript">

jQuery("[id*='query']").click(function(e){
                                var toeval=e.currentTarget.id+".toString().replace(/;/g,'').replace(/noasm/g,'').replace('\"q_sums\",300','\"q_sums\",200').replace(/}\w*/,'').replace('return','').replace(/function query.*{/,'')";
                                document.getElementById("TAFluent")
                                  .value=eval(toeval)+"  .materialize();\nprinttable(res.toHTMLTableN(100))";
                                  e.preventDefault();});
</script>

</body>
</html>
